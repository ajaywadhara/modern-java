# Java 12-17 Features

## Switch Expressions (Java 14+)

```java
// BEFORE: Traditional switch with breaks
int numLetters;
switch (day) {
    case MONDAY:
    case FRIDAY:
        numLetters = 6;
        break;
    default:
        numLetters = 0;
}

// AFTER: Switch expression with arrows
int numLetters = switch (day) {
    case MONDAY, FRIDAY -> 6;
    case TUESDAY -> 7;
    default -> 0;
};

// With yield for complex logic
int result = switch (value) {
    case 1 -> 1;
    case 2 -> {
        System.out.println("Case 2");
        yield 2;
    }
    default -> 0;
};
```

---

## Text Blocks (Java 15+)

```java
// BEFORE: Escaped strings
String json = "{\n" +
    "  \"name\": \"" + name + "\"\n" +
    "}";

// AFTER: Text blocks
String json = """
    {
        "name": "%s"
    }
    """.formatted(name);

// SQL example
String sql = """
    SELECT id, name
    FROM users
    WHERE active = true
    ORDER BY created_at
    """;
```

---

## Records (Java 16+)

```java
// BEFORE: Verbose POJO (50+ lines)
public class Person {
    private final String name;
    private final int age;
    public Person(String name, int age) { ... }
    public String getName() { return name; }
    public int getAge() { return age; }
    // equals, hashCode, toString...
}

// AFTER: Record (1 line)
public record Person(String name, int age) {}

// With validation (compact constructor)
public record Person(String name, int age) {
    public Person {
        if (age < 0) throw new IllegalArgumentException();
    }
}

// With methods
public record Person(String name, int age) {
    public boolean isAdult() { return age >= 18; }
}
```

**Use cases:**
```java
// DTOs
public record UserDTO(Long id, String email) {}

// API responses
public record ApiResponse<T>(int status, String message, T data) {}

// Configuration
public record Config(String url, int port) {}
```

---

## Pattern Matching for instanceof (Java 16+)

```java
// BEFORE: Type check + cast
if (obj instanceof String) {
    String s = (String) obj;
    return s.length();
}

// AFTER: Pattern variable
if (obj instanceof String s) {
    return s.length();
}

// With condition
if (obj instanceof String s && s.length() > 5) {
    return s.toUpperCase();
}
```

---

## Sealed Classes (Java 17+)

```java
// BEFORE: Open hierarchy
interface Shape {}

// AFTER: Controlled hierarchy
sealed interface Shape permits Circle, Rectangle, Square {
    double area();
}

record Circle(double radius) implements Shape {
    public double area() { return Math.PI * radius * radius; }
}

record Rectangle(double width, double height) implements Shape {
    public double area() { return width * height; }
}

// non-sealed allows further extension
non-sealed class Square extends Rectangle {
    public Square(double side) { super(side, side); }
}
```

**With records:**
```java
sealed interface JsonValue permits JsonString, JsonNumber, JsonObject {}

record JsonString(String value) implements JsonValue {}
record JsonNumber(double value) implements JsonValue {}
record JsonObject(Map<String, JsonValue> fields) implements JsonValue {}
```

---

## Helpful NullPointerExceptions (Java 14+)

```java
// BEFORE: Generic NPE
Exception in thread "main" java.lang.NullPointerException
    at Main.main(Main.java:5)

// AFTER: Detailed message
Exception in thread "main" java.lang.NullPointerException: 
    Cannot invoke "String.length()" because "name" is null
    at Main.main(Main.java:5)
```

---

## Pattern Detection Regex

| Legacy Pattern | Detection | Modern Alternative |
|---------------|-----------|-------------------|
| switch with breaks | `switch.*case.*:` | Switch expression |
| Multi-line string | `".*\\n"\s*\+` | Text block |
| DTO with getters/setters | `public void set\w+` | Record |
| instanceof + cast | `instanceof.*\(\w+\)` | Pattern matching |

---

## Version Features

| Version | Features |
|---------|----------|
| 12 | Switch expressions (preview), Compact number format |
| 13 | Text blocks (preview) |
| 14 | Records (preview), Helpful NPEs, Pattern matching instanceof (preview) |
| 15 | Text blocks (final), Sealed classes (preview) |
| 16 | Records (final), Pattern matching instanceof (final) |
| 17 | Sealed classes (final), Pattern matching switch (preview) |
